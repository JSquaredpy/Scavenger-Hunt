<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Scavenger Hunt Intro</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
  body {
    background: #222;
    color: #eee;
    font-family: 'Press Start 2P', cursive, monospace;
    text-align: center;
    margin: 0;
    padding: 0;
    overflow-x: hidden;
  }
  canvas {
    background: #333;
    display: block;
    margin: 20px auto;
    border: 4px solid #555;
    image-rendering: pixelated;
  }
  #introText {
    max-width: 600px;
    margin: 20px auto;
    font-size: 14px;
    line-height: 1.4;
  }
  #nextBtn {
    background: #4caf50;
    border: none;
    color: white;
    padding: 10px 25px;
    font-size: 16px;
    cursor: pointer;
    margin-top: 15px;
    border-radius: 5px;
  }
  #nextBtn:disabled {
    background: #888;
    cursor: default;
  }
</style>
</head>
<body>

<canvas id="gameCanvas" width="320" height="160"></canvas>
<div id="introText"></div>
<button id="nextBtn" disabled>Next Clue</button>

<audio id="itemSound" src="https://freesound.org/data/previews/341/341695_6265686-lq.mp3"></audio>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

const SPRITE_SIZE = 32;
let frame = 0;
let posX = -SPRITE_SIZE;
const WALK_SPEED = 2;
let animState = 'walking'; // 'walking', 'opening', 'done'

const introText = `Welcome to the adventure, space traveller.\n
You will journey through 21st century London as it existed over 4000 years ago.\n
To avoid detection, you must dress, act, and behave like someone of this time.\n
I've implanted your mission brief into your neuronic chip — plus a translator to convert native ÆEalt into primitive English.\n
Your mission: follow the footsteps of Joel Jack on Thursday 14th August 2025.\n
Assume the identity of his girlfriend, Jadine Downes.\n
Good luck, traveller.`;

const introDiv = document.getElementById('introText');
const nextBtn = document.getElementById('nextBtn');
const itemSound = document.getElementById('itemSound');

function drawSprite(x, y, frameIndex, action) {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  if(action === 'walking'){
    ctx.fillStyle = '#0f0'; // green
    ctx.fillRect(x, y, SPRITE_SIZE, SPRITE_SIZE);
    // legs animation
    if(frameIndex % 2 === 0){
      ctx.fillStyle = '#070';
      ctx.fillRect(x + 8, y + 24, 6, 8);
      ctx.fillRect(x + 18, y + 24, 6, 8);
    } else {
      ctx.fillRect(x + 10, y + 24, 6, 8);
      ctx.fillRect(x + 16, y + 24, 6, 8);
    }
  } else if(action === 'opening'){
    ctx.fillStyle = '#cc0'; // yellow chest
    ctx.fillRect(x, y, SPRITE_SIZE, SPRITE_SIZE);
    ctx.fillStyle = '#ff0';
    ctx.fillRect(x, y - 10, SPRITE_SIZE, 10);
  } else if(action === 'done'){
    ctx.fillStyle = '#0ff'; // cyan happy sprite
    ctx.fillRect(x, y, SPRITE_SIZE, SPRITE_SIZE);
    ctx.fillStyle = '#fff';
    ctx.font = '16px monospace';
    ctx.fillText('★', x + 10, y + 20);
  }
}

function typeText(text, element, speed = 30, callback) {
  let i = 0;
  element.textContent = '';
  function type() {
    if(i < text.length){
      element.textContent += text.charAt(i);
      i++;
      setTimeout(type, speed);
    } else if(callback){
      callback();
    }
  }
  type();
}

function animate(){
  if(animState === 'walking'){
    drawSprite(posX, 100, frame, 'walking');
    posX += WALK_SPEED;
    if(posX >= canvas.width / 2 - SPRITE_SIZE / 2){
      animState = 'opening';
      itemSound.play();
      setTimeout(() => {
        animState = 'done';
        typeText(introText, introDiv, 25, () => {
          nextBtn.disabled = false;
        });
      }, 1000);
    }
  } else if(animState === 'opening'){
    drawSprite(posX, 100, frame, 'opening');
  } else if(animState === 'done'){
    drawSprite(posX, 100, frame, 'done');
  }
  frame = (frame + 1) % 2;
  requestAnimationFrame(animate);
}

nextBtn.addEventListener('click', () => {
  alert('Next clue coming soon!');
  // You can add redirect here for next clue page.
});

animate();
</script>

</body>
</html>
